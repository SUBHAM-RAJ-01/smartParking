{"ast":null,"code":"import React,{useEffect,useState}from'react';import API from'../api';import'../App.css';import{jsxs as _jsxs,jsx as _jsx,Fragment as _Fragment}from\"react/jsx-runtime\";export default function Wallet(_ref){let{licensePlate,startPayment}=_ref;const[wallet,setWallet]=useState(0);const[transactions,setTransactions]=useState([]);const[isLoading,setIsLoading]=useState(false);const[amount,setAmount]=useState('');const fetchWallet=async()=>{setIsLoading(true);try{const res=await API.get(\"/wallet/\".concat(licensePlate));setWallet(res.data.wallet);setTransactions(res.data.transactions);}catch(err){console.error('Error fetching wallet data',err);}finally{setIsLoading(false);}};useEffect(()=>{fetchWallet();},[licensePlate]);const handleAddMoney=e=>{e.preventDefault();if(!amount||isNaN(amount)||Number(amount)<=0){return;}// Start payment flow with selected amount\nstartPayment(Number(amount));setAmount('');};const formatTransactionDate=timestamp=>{const date=new Date(timestamp);return date.toLocaleDateString('en-IN');};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"wallet-header\",children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"wallet-balance\",children:[\"Wallet Balance: \\u20B9\",wallet]}),/*#__PURE__*/_jsx(\"div\",{className:\"wallet-actions\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleAddMoney,className:\"add-money-form\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Enter amount\",value:amount,onChange:e=>setAmount(e.target.value),min:\"1\",required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn\",children:\"Add Money\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"transactions-container\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Recent Transactions\"}),isLoading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading transactions...\"}):transactions.length>0?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"transaction-header\",children:[/*#__PURE__*/_jsx(\"div\",{children:\"Transaction\"}),/*#__PURE__*/_jsx(\"div\",{children:\"Amount\"})]}),/*#__PURE__*/_jsx(\"ul\",{className:\"transaction-list\",children:transactions.map(txn=>/*#__PURE__*/_jsxs(\"li\",{className:\"transaction-item\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{children:txn.method}),/*#__PURE__*/_jsx(\"div\",{className:\"transaction-date\",children:formatTransactionDate(txn.timestamp)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"transaction-amount \".concat(txn.type==='add'?'amount-add':'amount-deduct'),children:[txn.type==='add'?'+':'-',\"\\u20B9\",txn.amount]})]},txn._id))})]}):/*#__PURE__*/_jsx(\"p\",{children:\"No recent transactions\"})]})]});}","map":{"version":3,"names":["React","useEffect","useState","API","jsxs","_jsxs","jsx","_jsx","Fragment","_Fragment","Wallet","_ref","licensePlate","startPayment","wallet","setWallet","transactions","setTransactions","isLoading","setIsLoading","amount","setAmount","fetchWallet","res","get","concat","data","err","console","error","handleAddMoney","e","preventDefault","isNaN","Number","formatTransactionDate","timestamp","date","Date","toLocaleDateString","children","className","onSubmit","type","placeholder","value","onChange","target","min","required","length","map","txn","method","_id"],"sources":["C:/Users/srajp/Desktop/wednesday/client/src/components/Wallet.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport API from '../api';\r\nimport '../App.css';\r\n\r\nexport default function Wallet({ licensePlate, startPayment }) {\r\n  const [wallet, setWallet] = useState(0);\r\n  const [transactions, setTransactions] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [amount, setAmount] = useState('');\r\n\r\n  const fetchWallet = async () => {\r\n    setIsLoading(true);\r\n    try {\r\n      const res = await API.get(`/wallet/${licensePlate}`);\r\n      setWallet(res.data.wallet);\r\n      setTransactions(res.data.transactions);\r\n    } catch (err) {\r\n      console.error('Error fetching wallet data', err);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchWallet();\r\n  }, [licensePlate]);\r\n\r\n  const handleAddMoney = (e) => {\r\n    e.preventDefault();\r\n    \r\n    if (!amount || isNaN(amount) || Number(amount) <= 0) {\r\n      return;\r\n    }\r\n    \r\n    // Start payment flow with selected amount\r\n    startPayment(Number(amount));\r\n    setAmount('');\r\n  };\r\n\r\n  const formatTransactionDate = (timestamp) => {\r\n    const date = new Date(timestamp);\r\n    return date.toLocaleDateString('en-IN');\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"wallet-header\">\r\n        <h4 className=\"wallet-balance\">Wallet Balance: ₹{wallet}</h4>\r\n        <div className=\"wallet-actions\">\r\n          <form onSubmit={handleAddMoney} className=\"add-money-form\">\r\n            <input\r\n              type=\"number\"\r\n              placeholder=\"Enter amount\"\r\n              value={amount}\r\n              onChange={(e) => setAmount(e.target.value)}\r\n              min=\"1\"\r\n              required\r\n            />\r\n            <button type=\"submit\" className=\"btn\">Add Money</button>\r\n          </form>\r\n        </div>\r\n      </div>\r\n      \r\n      <div className=\"transactions-container\">\r\n        <h5>Recent Transactions</h5>\r\n        \r\n        {isLoading ? (\r\n          <p>Loading transactions...</p>\r\n        ) : transactions.length > 0 ? (\r\n          <>\r\n            <div className=\"transaction-header\">\r\n              <div>Transaction</div>\r\n              <div>Amount</div>\r\n            </div>\r\n            <ul className=\"transaction-list\">\r\n              {transactions.map(txn => (\r\n                <li key={txn._id} className=\"transaction-item\">\r\n                  <div>\r\n                    <div>{txn.method}</div>\r\n                    <div className=\"transaction-date\">{formatTransactionDate(txn.timestamp)}</div>\r\n                  </div>\r\n                  <div className={`transaction-amount ${txn.type === 'add' ? 'amount-add' : 'amount-deduct'}`}>\r\n                    {txn.type === 'add' ? '+' : '-'}₹{txn.amount}\r\n                  </div>\r\n                </li>\r\n              ))}\r\n            </ul>\r\n          </>\r\n        ) : (\r\n          <p>No recent transactions</p>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}